const { readProject } = require('../../projectReader')
const mvn = require('../../mvn')


module.exports = class Handler extends require('../../plugin') {

  static help() {
    return 'add handler stubs for actions and functions (Java)' 
  }

  options() {
    return {
      'filter': {
        type: 'string',
        short: 'f',
        help: `Filter actions or functions by name prefix. Regular expressions are not supported.`
      },
      'out': {
        type: 'string',
        short: 'o',
        help: 'Specify a custom output directory inside the `handlers` directory. The default is `handlers`.'
      }
    }
  }

  canRun() {
    const { isJava } = readProject()
    if (!isJava) {
      throw `No Java project detected. 'cds add handler' is currently only supported for Java projects.\n`
    }
    return true
  }

  async run() {
    await mvn.generate('handler')
  }
}
